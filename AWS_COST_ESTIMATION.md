# AWS デプロイ・運用費用見積もり

## 初期デプロイ費用
**ほぼ無料**（AWS無料利用枠内で収まる可能性が高い）

### デプロイ時にかかる費用
1. **S3（デプロイアーティファクト保存）**
   - 料金: $0.025/GB/月
   - 見積: 約10MB程度 = **$0.0003/月**

2. **CloudFormation**
   - 料金: **無料**（スタック操作は無料）

3. **初回のビルド時間**
   - Amplify: 最初の1000分/月は無料
   - 見積: **無料**

## 月間ランニングコスト見積もり

### 想定利用規模（小〜中規模サイト）
- 月間訪問者: 1,000〜5,000人
- ページビュー: 10,000〜50,000 PV
- お問い合わせ: 月50〜200件

### 詳細コスト内訳

#### 1. AWS Amplify（フロントエンド）
```
ホスティング:
- ストレージ: $0.023/GB/月
  見積: 100MB = $0.0023/月
  
- データ転送: $0.15/GB
  見積: 5GB/月 = $0.75/月
  
- ビルド時間: $0.01/分（1000分/月まで無料）
  見積: 月10回デプロイ×3分 = 30分 = 無料
  
小計: 約$0.75/月
```

#### 2. Lambda（バックエンド）
```
リクエスト数:
- 最初の100万リクエスト/月: 無料
- その後: $0.20/100万リクエスト
  見積: 月200件のお問い合わせ = 無料

実行時間:
- 最初の400,000 GB-秒/月: 無料
- メモリ: 128MB、実行時間: 1秒/リクエスト
  見積: 200件 × 0.128GB × 1秒 = 25.6 GB-秒 = 無料
  
小計: 無料
```

#### 3. API Gateway
```
REST API:
- 最初の100万リクエスト/月: $3.50
- データ転送: $0.09/GB（最初の10TBまで）
  見積: 200リクエスト/月 = 無料（12ヶ月の無料利用枠）
  見積（無料枠後）: $0.0007/月
  
小計: 無料〜$0.001/月
```

#### 4. CloudWatch Logs
```
ログ取り込み: $0.76/GB
ログ保存: $0.033/GB/月
見積: 10MB/月 = $0.008/月

小計: 約$0.01/月
```

## 料金シミュレーション

### 最小規模（月間訪問者 100人、お問い合わせ 10件）
| サービス | 月額費用 |
|---------|---------|
| Amplify | $0.10 |
| Lambda | $0.00 |
| API Gateway | $0.00 |
| CloudWatch | $0.01 |
| **合計** | **約$0.11/月（約17円）** |

### 小規模（月間訪問者 1,000人、お問い合わせ 50件）
| サービス | 月額費用 |
|---------|---------|
| Amplify | $0.50 |
| Lambda | $0.00 |
| API Gateway | $0.00 |
| CloudWatch | $0.01 |
| **合計** | **約$0.51/月（約80円）** |

### 中規模（月間訪問者 5,000人、お問い合わせ 200件）
| サービス | 月額費用 |
|---------|---------|
| Amplify | $2.00 |
| Lambda | $0.00 |
| API Gateway | $0.001 |
| CloudWatch | $0.05 |
| **合計** | **約$2.05/月（約320円）** |

### 大規模（月間訪問者 50,000人、お問い合わせ 1,000件）
| サービス | 月額費用 |
|---------|---------|
| Amplify | $15.00 |
| Lambda | $0.00 |
| API Gateway | $0.004 |
| CloudWatch | $0.20 |
| **合計** | **約$15.20/月（約2,400円）** |

## AWS無料利用枠

### 新規アカウントの場合（12ヶ月間）
- **Lambda**: 100万リクエスト/月、400,000 GB-秒/月
- **API Gateway**: 100万リクエスト/月（12ヶ月）
- **Amplify**: ビルド1000分/月
- **CloudWatch**: 5GB のログデータ取り込み
- **S3**: 5GB のストレージ

### 永続的な無料枠
- **Lambda**: 100万リクエスト/月、400,000 GB-秒/月は永続的に無料

## コスト最適化のヒント

### 1. Amplifyの最適化
```yaml
# amplify.yml でキャッシュを有効化
cache:
  paths:
    - client/node_modules/**/*
```

### 2. CloudWatchログの保持期間設定
```bash
# 30日で自動削除
aws logs put-retention-policy \
  --log-group-name /aws/lambda/your-function \
  --retention-in-days 30
```

### 3. Lambda関数の最適化
- メモリサイズを最小限に（128MB）
- タイムアウトを適切に設定（30秒）
- コールドスタート対策

### 4. 静的アセットの最適化
- 画像の圧縮（WebP形式の使用）
- CSSとJavaScriptの最小化
- gzip圧縮の有効化

## 他サービスとの比較

### Vercel（無料プラン）
- **メリット**: 完全無料、デプロイ簡単
- **デメリット**: 商用利用制限、カスタマイズ制限
- **月額**: $0

### Vercel（Proプラン）
- **月額**: $20/月（約3,100円）
- **含まれるもの**: 無制限のデプロイ、分析機能

### Netlify（無料プラン）
- **月額**: $0
- **制限**: 100GB帯域幅/月、300分ビルド/月

### Heroku（廃止された無料プラン後）
- **最小プラン**: $5-7/月
- **デメリット**: スリープ機能あり

## 年間コスト予測

### 企業サイトとして現実的な見積もり
```
想定:
- 月間10,000 PV
- お問い合わせ月100件
- 月5回の更新

年間コスト:
- 月額: 約$1.50（約230円）
- 年額: 約$18（約2,800円）
```

## 結論

### デプロイ時の費用
- **初期費用**: ほぼ$0（無料）

### 運用費用
- **小規模サイト**: 月額$0.50〜$2（約80〜320円）
- **中規模サイト**: 月額$2〜$15（約320〜2,400円）
- **大規模サイト**: 月額$15〜$50（約2,400〜8,000円）

### このシステムの予想コスト
現実的な企業サイトとして：
- **月額**: 約$1〜3（約150〜500円）
- **年額**: 約$12〜36（約2,000〜6,000円）

**Vercelの無料プランと比較すると若干費用がかかりますが、AWSの柔軟性とスケーラビリティを考慮すると非常にコストパフォーマンスが高いと言えます。**

## 請求アラートの設定

予想外の請求を防ぐため：

```bash
# 月$10を超えたらアラート
aws budgets create-budget \
  --account-id YOUR_ACCOUNT_ID \
  --budget file://budget.json \
  --notifications-with-subscribers file://notifications.json
```

budget.json:
```json
{
  "BudgetName": "monthly-budget",
  "BudgetLimit": {
    "Amount": "10",
    "Unit": "USD"
  },
  "TimeUnit": "MONTHLY",
  "BudgetType": "COST"
}
```